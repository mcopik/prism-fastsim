#define __LOG_TBL_LENGTH_DOUBLE 9
#define __TBL_LENGTH_DOUBLE (1 << __LOG_TBL_LENGTH_DOUBLE)

__constant uint __ziggurat_normal_mask_double = ((uint) -1) >> (32 - __LOG_TBL_LENGTH_DOUBLE);
__constant double __ziggurat_normal_x1_double = 3.8530465923552736;
__constant double __ziggurat_normal_inv_x1_double = 0.25953488389786752;


__constant double  __ziggurat_normal_double_tbl_x[__TBL_LENGTH_DOUBLE + 1] = 
{4.0968586097934827,3.8520461503683912,3.6591529330911164,3.5387147915535359,3.4499415844581948,3.3791208509098653,3.3199242727525520,3.2688953201247243,3.2239336074705574,3.1836646787008854,3.1471385926519712,3.1136706092218944,3.0827503897194092,3.0539870972903128,3.0270745842754689,3.0017684330687534,2.9778703072041906,2.9552169815083583,2.9336724639032943,2.9131222169485817,2.8934688401496455,2.8746287902796272,2.8565298533366061,2.8391091700186590,2.8223116750508611,2.8060888502170392,2.7903977181709911,2.7752000231739453,2.7604615584754485,2.7461516098484305,2.7322424919497175,2.7187091594759438,2.7055288790496144,2.6926809507675676,2.6801464706321721,2.6679081268478898,2.6559500243346071,2.6442575328806557,2.6328171552034775,2.6216164118569691,2.6106437404609705,2.5998884071598398,2.5893404285661339,2.5789905027294192,2.5688299479025083,2.5588506480683336,2.5490450043483498,2.5394058915441638,2.5299266191730942,2.5206008964495547,2.5114228007407585,2.5023867490898326,2.4934874724540813,2.4847199923525551,2.4760795996566162,2.4675618352909908,2.4591624726417722,2.4508775014927480,2.4427031133329121,2.4346356878965929,2.4266717808137350,2.4188081122618657,2.4110415565234738,2.4033691323631760,2.3957879941483700,2.3882954236452498,2.3808888224292500,2.3735657048553191,2.3663236915390124,2.3591605033043417,2.3520739555587000,2.3450619530590706,2.3381224850371873,2.3312536206543983,2.3244535047597318,2.3177203539271236,2.3110524527499645,2.3044481503730991,2.2979058572441794,2.2914240420678696,2.2850012289478306,2.2786359947027097,2.2723269663435255,2.2660728187008963,2.2598722721915137,2.2537240907141323,2.2476270796661295,2.2415800840724064,2.2355819868190481,2.2296317069847555,2.2237281982635985,2.2178704474731334,2.2120574731423764,2.2062883241745377,2.2005620785797949,2.1948778422737315,2.1892347479373814,2.1836319539351109,2.1780686432868369,2.1725440226913261,2.1670573215975428,2.1616077913212271,2.1561947042040695,2.1508173528130321,2.1454750491775266,2.1401671240623097,2.1348929262740997,2.1296518220000450,2.1244431941762954,2.1192664418850403,2.1141209797784779,2.1090062375282789,2.1039216592991946,2.0988667032455423,2.0938408410293801,2.0888435573592524,2.0838743495484545,2.0789327270918298,2.0740182112601659,2.0691303347113164,2.0642686411172195,2.0594326848060371,2.0546220304186797,2.0498362525790223,2.0450749355771602,2.0403376730650835,2.0356240677641887,2.0309337311840735,2.0262662833520941,2.0216213525531890,2.0169985750795031,2.0123975949893673,2.0078180638752146,2.0032596406400350,1.9987219912819901,1.9942047886868308,1.9897077124277773,1.9852304485725390,1.9807726894971676,1.9763341337064515,1.9719144856605762,1.9675134556077848,1.9631307594227913,1.9587661184507046,1.9544192593562404,1.9500899139780004,1.9457778191876175,1.9414827167535663,1.9372043532094561,1.9329424797266246,1.9286968519908639,1.9244672300831170,1.9202533783639877,1.9160550653619177,1.9118720636648895,1.9077041498155190,1.9035511042094096,1.8994127109966441,1.8952887579862965,1.8911790365538510,1.8870833415514195,1.8830014712206555,1.8789332271082637,1.8748784139840128,1.8708368397611575,1.8668083154191869,1.8627926549288112,1.8587896751791113,1.8547991959067708,1.8508210396273195,1.8468550315683164,1.8429009996044052,1.8389587741941765,1.8350281883187756,1.8311090774221942,1.8272012793531899,1.8233046343087771,1.8194189847792369,1.8155441754945940,1.8116800533725120,1.8078264674675599,1.8039832689218035,1.8001503109166781,1.7963274486261016,1.7925145391707853,1.7887114415737045,1.7849180167166913,1.7811341272981129,1.7773596377916004,1.7735944144057943,1.7698383250450752,1.7660912392712462,1.7623530282661394,1.7586235647951147,1.7549027231714249,1.7511903792214188,1.7474864102505558,1.7437906950102073,1.7401031136652208,1.7364235477622212,1.7327518801986285,1.7290879951923689,1.7254317782522580,1.7217831161490343,1.7181418968870262,1.7145080096764288,1.7108813449061757,1.7072617941173850,1.7036492499773638,1.7000436062541523,1.6964447577915930,1.6928526004849079,1.6892670312567682,1.6856879480338421,1.6821152497238058,1.6785488361928036,1.6749886082433434,1.6714344675926146,1.6678863168512151,1.6643440595022755,1.6608075998809673,1.6572768431543845,1.6537516953017864,1.6502320630951906,1.6467178540803049,1.6432089765577891,1.6397053395648339,1.6362068528570498,1.6327134268906535,1.6292249728049442,1.6257414024050602,1.6222626281450062,1.6187885631109426,1.6153191210047294,1.6118542161277145,1.6083937633647595,1.6049376781684953,1.6014858765437981,1.5980382750324798,1.5945947906981849,1.5911553411114858,1.5877198443351710,1.5842882189097174,1.5808603838389411,1.5774362585758194,1.5740157630084784,1.5705988174463378,1.5671853426064083,1.5637752595997354,1.5603684899179821,1.5569649554201453,1.5535645783194007,1.5501672811700688,1.5467729868546979,1.5433816185712570,1.5399930998204339,1.5366073543930328,1.5332243063574660,1.5298438800473342,1.5264660000490895,1.5230905911897777,1.5197175785248521,1.5163468873260558,1.5129784430693663,1.5096121714229974,1.5062479982354535,1.5028858495236314,1.4995256514609645,1.4961673303656038,1.4928108126886319,1.4894560250023045,1.4861028939883133,1.4827513464260682,1.4794013091809903,1.4760527091928140,1.4727054734638911,1.4693595290474926,1.4660148030361038,1.4626712225497066,1.4593287147240453,1.4559872066988694,1.4526466256061495,1.4493068985582607,1.4459679526361285,1.4426297148773315,1.4392921122641568,1.4359550717116014,1.4326185200553153,1.4292823840394803,1.4259465903046195,1.4226110653753316,1.4192757356479440,1.4159405273780803,1.4126053666681344,1.4092701794546478,1.4059348914955811,1.4025994283574768,1.3992637154025044,1.3959276777753835,1.3925912403901770,1.3892543279169491,1.3859168647682801,1.3825787750856321,1.3792399827255585,1.3759004112457492,1.3725599838909057,1.3692186235784370,1.3658762528839699,1.3625327940266654,1.3591881688543321,1.3558422988283305,1.3524951050082579,1.3491465080364050,1.3457964281219778,1.3424447850250714,1.3390914980403911,1.3357364859807063,1.3323796671600313,1.3290209593765195,1.3256602798950626,1.3222975454295825,1.3189326721250059,1.3155655755389076,1.3121961706228144,1.3088243717031530,1.3054500924618322,1.3020732459164446,1.2986937444000756,1.2953114995407035,1.2919264222401785,1.2885384226527642,1.2851474101632264,1.2817532933644530,1.2783559800345888,1.2749553771136677,1.2715513906797238,1.2681439259243646,1.2647328871277857,1.2613181776332072,1.2578996998207125,1.2544773550804666,1.2510510437852929,1.2476206652625854,1.2441861177655313,1.2407472984436212,1.2373041033124196,1.2338564272225693,1.2304041638280032,1.2269472055533323,1.2234854435603823,1.2200187677138457,1.2165470665460188,1.2130702272205869,1.2095881354954267,1.2061006756843844,1.2026077306179960,1.1991091816031061,1.1956049083813462,1.1920947890864287,1.1885787002002105,1.1850565165074805,1.1815281110494211,1.1779933550756928,1.1744521179950877,1.1709042673246970,1.1673496686375333,1.1637881855085470,1.1602196794589722,1.1566440098989368,1.1530610340682651,1.1494706069754009,1.1458725813343748,1.1422668074997339,1.1386531333993515,1.1350314044650283,1.1314014635607919,1.1277631509087991,1.1241163040127380,1.1204607575786250,1.1167963434328824,1.1131228904375819,1.1094402244027277,1.1057481679954507,1.1020465406459779,1.0983351584502320,1.0946138340689101,1.0908823766228843,1.0871405915847540,1.0833882806663750,1.0796252417021791,1.0758512685280875,1.0720661508558112,1.0682696741423201,1.0644616194542495,1.0606417633270015,1.0568098776182818,1.0529657293558021,1.0491090805788573,1.0452396881734747,1.0413573037008119,1.0374616732184601,1.0335525370942926,1.0296296298124721,1.0256926797712092,1.0217414090718413,1.0177755332987681,1.0137947612897587,1.0097987948961083,1.0057873287320922,1.0017600499131289,0.99771663778202386,0.99365676362262742,0.98958009036019242,0.98548627224767178,0.98137495453714329,0.97724577313549378,0.97309835424343434,0.96893231397685361,0.96474725796944561,0.96054278095547278,0.95631846633144233,0.95207388569538497,0.94780859836232798,0.94352215085444960,0.93921407636428721,0.93488389418924775,0.93053110913553288,0.92615521088944445,0.92175567335387426,0.91733195394760656,0.91288349286486954,0.90840971229236151,0.90391001558074722,0.89938378636736689,0.89483038764662324,0.89024916078420654,0.88563942447098232,0.88100047361199640,0.87633157814564388,0.87163198178759812,0.86690090069359742,0.86213752203463460,0.85734100247748310,0.85251046656281246,0.84764500497239050,0.84274367267602633,0.83780548694796916,0.83282942524142711,0.82781442290869528,0.82275937075306456,0.81766311239720276,0.81252444145103524,0.80734209846027550,0.80211476761463789,0.79684107319236703,0.79151957571500099,0.78614876778319769,0.78072706956093855,0.77525282387141246,0.76972429086329515,0.76413964220087982,0.75849695472546989,0.75279420352847999,0.74702925436864418,0.74119985535640807,0.73530362781775002,0.72933805623705432,0.72330047716390393,0.71718806695135605,0.71099782817290079,0.70472657454125688,0.69837091412365693,0.69192723061436353,0.68539166238464561,0.67876007898184343,0.67202805469058628,0.66519083869832794,0.65824332132111363,0.65117999564002287,0.64399491376906305,0.63668163681495120,0.62923317738976046,0.62164193328768472,0.61389961062239262,0.60599713432177939,0.59792454336558270,0.58967086749171697,0.58122398123882471,0.57257043006502768,0.56369522178677684,0.55458157457489263,0.54521061002124009,0.53556097604563260,0.52560837919470082,0.51532499850163813,0.50467874245534135,0.49363229506874705,0.48214187377839369,0.47015558635112077,0.45761121823148548,0.44443319185881793,0.43052828972059037,0.41577947401088002,0.40003666850050176,0.38310248105129543,0.36470905546562093,0.34447835352767045,0.32184890256690199,0.29592714272092498,0.26514267174790225,0.22626870482801179,0.17041758857748693,0.};


__constant double  __ziggurat_normal_double_tbl_y[__TBL_LENGTH_DOUBLE + 1] = 
{0.,0.00059967076863929120,0.0012374529383327676,0.0019088559642418188,0.0026031098095659308,0.0033152280560339171,0.0040422711124785673,0.0047822778565192826,0.0055338364446504003,0.0062958764400921464,0.0070675551812539999,0.0078481901228728671,0.0086372158933782775,0.0094341556520218470,0.010238601209018847,0.011050198770672381,0.011868638435929892,0.012693646276465406,0.013524978245290047,0.014362415410403085,0.015205760168562512,0.016054833197257818,0.016909470971654552,0.017769523720156970,0.018634853724894057,0.019505333896612541,0.020380846570187127,0.021261282479212913,0.022146539877247812,0.023036523780120265,0.023931145308928339,0.024830321117364074,0.025733972890110123,0.026642026901496007,0.027554413625530667,0.028471067389965367,0.029391926068275255,0.030316930804445638,0.031246025766260856,0.032179157923458261,0.033116276847657074,0.034057334531424969,0.035002285224222268,0.035951085283278932,0.036903693037724437,0.037860068664514114,0.038820174074884961,0.039783972810235032,0.040751429946458121,0.041722512005883366,0.042697186876070822,0.043675423734801546,0.044657192980676481,0.045642466168804198,0.046631215951114787,0.047623416020887205,0.048619041061121156,0.049618066696422982,0.050620469448108867,0.051626226692258466,0.052635316620478438,0.053647718203158700,0.054663411155024979,0.055682375902809672,0.056704593554879488,0.057730045872673017,0.058758715243814548,0.059790584656782217,0.060825637677019173,0.061863858424385955,0.062905231551860878,0.063949742225402938,0.064997376104898774,0.066048119326121541,0.067101958483635310,0.068158880614583806,0.069218873183307049,0.070281924066733777,0.071348021540501454,0.072417154265759265,0.073489311276612775,0.074564481968171929,0.075642656085166814,0.076723823711098138,0.077807975257891670,0.078895101456028038,0.079985193345121208,0.081078242264920791,0.082174239846714973,0.083273178005112387,0.084375048930182683,0.085479845079936832,0.086587559173129427,0.087698184182366349,0.088811713327502234,0.089928140069313085,0.091047458103430340,0.092169661354523460,0.093294743970718937,0.094422700318244306,0.095553524976286419,0.096687212732053876,0.097823758576034074,0.098963157697435886,0.10010540547980949,0.10125049749683535,0.10239842950827477,0.10354919745607485,0.10470279746062118,0.10585922581713175,0.10701847899218610,0.10818055362038395,0.10934544650112794,0.11051315459552518,0.11168367502340294,0.11285700506043362,0.11403314213536481,0.11521208382735007,0.11639382786337671,0.11757837211578645,0.11876571459988575,0.11995585347164215,0.12114878702546342,0.12234451369205656,0.12354303203636350,0.12474434075557090,0.12594843867719125,0.12715532475721275,0.12836499807831566,0.12957745784815256,0.13079270339769061,0.13201073417961346,0.13323154976678093,0.13445514985074454,0.13568153424031694,0.13691070286019367,0.13814265574962541,0.13937739306113921,0.14061491505930717,0.14185522211956103,0.14309831472705139,0.14434419347555014,0.14559285906639482,0.14684431230747373,0.14809855411225058,0.14935558549882757,0.15061540758904586,0.15187802160762228,0.15314342888132154,0.15441163083816265,0.15568262900665901,0.15695642501509103,0.15823302059081058,0.15951241755957647,0.16079461784492020,0.16207962346754118,0.16336743654473081,0.16465805928982476,0.16595149401168269,0.16724774311419497,0.16854680909581569,0.16984869454912141,0.17115340216039522,0.17246093470923539,0.17377129506818841,0.17508448620240565,0.17640051116932342,0.17771937311836586,0.17904107529067033,0.18036562101883488,0.18169301372668742,0.18302325692907625,0.18435635423168161,0.18569230933084793,0.18703112601343644,0.18837280815669792,0.18971735972816520,0.19106478478556529,0.19241508747675077,0.19376827203965025,0.19512434280223772,0.19648330418252044,0.19784516068854541,0.19920991691842397,0.20057757756037451,0.20194814739278315,0.20332163128428211,0.20469803419384571,0.20607736117090394,0.20745961735547328,0.20884480797830485,0.21023293836104972,0.21162401391644124,0.21301804014849442,0.21441502265272214,0.21581496711636827,0.21721787931865757,0.21862376513106232,0.22003263051758565,0.22144448153506163,0.22285932433347188,0.22427716515627897,0.22569801034077638,0.22712186631845513,0.22854873961538709,0.22997863685262494,0.23141156474661886,0.23284753010964997,0.23428653985028055,0.23572860097382109,0.23717372058281427,0.23862190587753589,0.24007316415651282,0.24152750281705815,0.24298492935582346,0.24444545136936846,0.24590907655474803,0.24737581271011681,0.24884566773535143,0.25031864963269049,0.25179476650739250,0.25327402656841187,0.25475643812909310,0.25624200960788335,0.25773074952906354,0.25922266652349819,0.26071776932940411,0.26221606679313828,0.26371756787000487,0.26522228162508192,0.26673021723406763,0.26824138398414665,0.26975579127487649,0.27127344861909445,0.27279436564384510,0.27431855209132882,0.27584601781987144,0.27737677280491543,0.27891082714003287,0.28044819103796042,0.28198887483165679,0.28353288897538283,0.28508024404580464,0.28663095074312015,0.28818501989220931,0.28974246244380847,0.29130328947570912,0.29286751219398154,0.29443514193422367,0.29600619016283562,0.29758066847832024,0.29915858861261023,0.30073996243242209,0.30232480194063761,0.30391311927771310,0.30550492672311707,0.30710023669679670,0.30869906176067373,0.31030141462017019,0.31190730812576459,0.31351675527457914,0.31512976921199847,0.31674636323332055,0.31836655078544040,0.31999034546856711,0.32161776103797494,0.32324881140578915,0.32488351064280710,0.32652187298035549,0.32816391281218434,0.32980964469639852,0.33145908335742750,0.33311224368803424,0.33476914075136384,0.33642978978303290,0.33809420619326045,0.33976240556904120,0.34143440367636212,0.34311021646246319,0.34478986005814340,0.34647335078011273,0.34816070513339138,0.34985193981375710,0.35154707171024175,0.35324611790767818,0.35494909568929851,0.35665602253938497,0.35836691614597462,0.36008179440361888,0.36180067541619945,0.36352357749980170,0.36525051918564693,0.36698151922308488,0.36871659658264784,0.37045577045916797,0.37219906027495905,0.37394648568306450,0.37569806657057304,0.37745382306200372,0.37921377552276198,0.38097794456266849,0.38274635103956249,0.38451901606298157,0.38629596099791968,0.38807720746866545,0.38986277736272267,0.39165269283481516,0.39344697631097810,0.39524565049273801,0.39704873836138367,0.39885626318233041,0.40066824850958005,0.40248471819027908,0.40430569636937767,0.40613120749439210,0.40796127632027344,0.40979592791438524,0.41163518766159322,0.41347908126946999,0.41532763477361780,0.41718087454311277,0.41903882728607366,0.42090152005535894,0.42276898025439536,0.42464123564314207,0.42651831434419376,0.42840024484902705,0.43028705602439392,0.43217877711886661,0.43407543776953827,0.43597706800888377,0.43788369827178545,0.43979535940272864,0.44171208266317187,0.44363389973909690,0.44556084274874415,0.44749294425053879,0.44943023725121345,0.45137275521413342,0.45332053206783051,0.45527360221475201,0.45723200054023137,0.45919576242168741,0.46116492373805939,0.46313952087948509,0.46511959075722981,0.46710517081387416,0.46909629903376890,0.47109301395376553,0.47309535467423149,0.47510336087035924,0.47711707280377893,0.47913653133448463,0.48116177793308458,0.48319285469338622,0.48522980434532742,0.48727267026826546,0.48932149650463609,0.49137632777399531,0.49343720948745714,0.49550418776254109,0.49757730943844375,0.49965662209174938,0.50174217405259511,0.50383401442130704,0.50593219308552408,0.50803676073782723,0.51014776889389285,0.51226526991118898,0.51438931700823487,0.51651996428444480,0.51865726674057792,0.52080128029981715,0.52295206182950099,0.52510966916353334,0.52727416112549742,0.52944559755250126,0.53162403931978332,0.53380954836610840,0.53600218771998507,0.53820202152673768,0.54040911507646746,0.54262353483293877,0.54484534846342851,0.54707462486957856,0.54931143421929280,0.55155584797972285,0.55380793895138831,0.55606778130348010,0.55833545061039769,0.56061102388957364,0.56289457964064186,0.56518619788600868,0.56748596021288913,0.56979394981687404,0.57211025154709728,0.57443495195307582,0.57676813933329986,0.57910990378565386,0.58146033725975441,0.58381953361129524,0.58618758865849507,0.58856460024074928,0.59095066827959234,0.59334589484208411,0.59575038420673959,0.59816424293212926,0.60058757992828402,0.60302050653104761,0.60546313657952753,0.60791558649680503,0.61037797537407471,0.61285042505839487,0.61533306024424135,0.61782600856906989,0.62032940071310526,0.62284337050358982,0.62536805502373932,0.62790359472667057,0.63045013355458311,0.63300781906349668,0.63557680255386660,0.63815723920742208,0.64074928823059646,0.64335311300494492,0.64596888124497336,0.64859676516383360,0.65123694164737288,0.65388959243706283,0.65655490432237213,0.65923306934319040,0.66192428500295808,0.66462875449320796,0.66734668693028016,0.67007829760503370,0.67282380824644428,0.67558344730005173,0.67835745022230065,0.68114605979190611,0.68394952643947344,0.68676810859670781,0.68960207306666709,0.69245169541664139,0.69531726039538610,0.69819906237659420,0.70109740583066950,0.70401260582705773,0.70694498856960944,0.70989489196769023,0.71286266624602305,0.71584867459654807,0.71885329387592178,0.72187691535265419,0.72491994550830542,0.72798280689763925,0.73106593907316688,0.73416979958011909,0.73729486502856978,0.74044163225020970,0.74361061954815065,0.74680236804914434,0.75001744316874599,0.75325643620126325,0.75651996604783494,0.75980868109771301,0.76312326127981519,0.76646442030392147,0.76983290811356189,0.77322951357575438,0.77665506743638211,0.78011044557425164,0.78359657259186921,0.78711442578686402,0.79066503955496213,0.79424951028370380,0.79786900180599039,0.80152475149440555,0.80521807709153622,0.80895038438879911,0.81272317588729514,0.81653806059991315,0.82039676518550717,0.82430114664506835,0.82825320685849094,0.83225510930154771,0.83630919835972605,0.84041802175358236,0.84458435671598554,0.84881124072428986,0.85310200780295709,0.85746033169251216,0.86189027755471387,0.86639636438865433,0.87098364102273834,0.87565777950452098,0.88042519105778283,0.88529317170540988,0.89027008747061363,0.89536561325908841,0.90059104590917841,0.90595972188053229,0.91148758612772333,0.91719398547522214,0.92310280614845496,0.92924415904180423,0.93565697668996873,0.94239321291641730,0.94952505828894232,0.95715834935175921,0.96546027910701055,0.97472610695488427,0.98558384511805076,1.};

